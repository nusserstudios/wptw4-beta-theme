var $=(l,i)=>(i=Symbol[l])?i:Symbol.for("Symbol."+l),L=l=>{throw TypeError(l)};var B=(l,i,o)=>{if(i!=null){typeof i!="object"&&typeof i!="function"&&L("Object expected");var e,s;o&&(e=i[$("asyncDispose")]),e===void 0&&(e=i[$("dispose")],o&&(s=e)),typeof e!="function"&&L("Object not disposable"),s&&(e=function(){try{s.call(this)}catch(t){return Promise.reject(t)}}),l.push([o,e,i])}else o&&l.push([o]);return i},U=(l,i,o)=>{var e=typeof SuppressedError=="function"?SuppressedError:function(r,n,p,u){return u=Error(p),u.name="SuppressedError",u.error=r,u.suppressed=n,u},s=r=>i=o?new e(r,i,"An error was suppressed during disposal"):(o=!0,r),t=r=>{for(;r=l.pop();)try{var n=r[1]&&r[1].call(r[2]);if(r[0])return Promise.resolve(n).then(t,p=>(s(p),t()))}catch(p){s(p)}if(o)throw i};return t()};import Y from"@alloc/quick-lru";import{compileAst as J,env as Z,Features as b,Instrumentation as ee}from"@tailwindcss/node";import{clearRequireCache as te}from"@tailwindcss/node/require-cache";import{Scanner as se}from"@tailwindcss/oxide";import{Features as E,transform as ie}from"lightningcss";import re from"node:fs";import m,{relative as W}from"node:path";import v from"postcss";var j=32;var H=40;function D(l,i=[]){for(let o=5;o<l.length;o++){let e=l.charCodeAt(o);if(e===j||e===H){let s=l.slice(0,o).trim(),t=l.slice(o).trim();return A(s,t,i)}}return A(l.trim(),"",i)}var q=64;function V(l,i=[]){return{kind:"rule",selector:l,nodes:i}}function A(l,i="",o=[]){return{kind:"at-rule",name:l,params:i,nodes:o}}function x(l,i=[]){return l.charCodeAt(0)===q?D(l,i):V(l,i)}function N(l,i,o=!1){return{kind:"declaration",property:l,value:i,important:o}}function k(l){return{kind:"comment",value:l}}function _(l){function i(e,s=0){let t="",r="  ".repeat(s);if(e.kind==="declaration")t+=`${r}${e.property}: ${e.value}${e.important?" !important":""};
`;else if(e.kind==="rule"){t+=`${r}${e.selector} {
`;for(let n of e.nodes)t+=i(n,s+1);t+=`${r}}
`}else if(e.kind==="at-rule"){if(e.nodes.length===0)return`${r}${e.name} ${e.params};
`;t+=`${r}${e.name}${e.params?` ${e.params} `:" "}{
`;for(let n of e.nodes)t+=i(n,s+1);t+=`${r}}
`}else if(e.kind==="comment")t+=`${r}/*${e.value}*/
`;else if(e.kind==="context"||e.kind==="at-root")return"";return t}let o="";for(let e of l){let s=i(e);s!==""&&(o+=s)}return o}import g from"postcss";var X=33;function z(l,i){let o=g.root();o.source=i;function e(s,t){if(s.kind==="declaration"){let r=g.decl({prop:s.property,value:s.value??"",important:s.important});r.source=i,t.append(r)}else if(s.kind==="rule"){let r=g.rule({selector:s.selector});r.source=i,r.raws.semicolon=!0,t.append(r);for(let n of s.nodes)e(n,r)}else if(s.kind==="at-rule"){let r=g.atRule({name:s.name.slice(1),params:s.params});r.source=i,r.raws.semicolon=!0,t.append(r);for(let n of s.nodes)e(n,r)}else if(s.kind==="comment"){let r=g.comment({text:s.value});r.raws.left="",r.raws.right="",r.source=i,t.append(r)}else s.kind==="at-root"||s.kind}for(let s of l)e(s,o);return o}function M(l){function i(e,s){if(e.type==="decl")s.push(N(e.prop,e.value,e.important));else if(e.type==="rule"){let t=x(e.selector);e.each(r=>i(r,t.nodes)),s.push(t)}else if(e.type==="atrule"){let t=A(`@${e.name}`,e.params);e.each(r=>i(r,t.nodes)),s.push(t)}else if(e.type==="comment"){if(e.text.charCodeAt(0)!==X)return;s.push(k(e.text))}}let o=[];return l.each(e=>i(e,o)),o}import{normalizePath as I}from"@tailwindcss/node";import y from"node:path";var R="'",P='"';function w(){let l=new WeakSet;function i(o){let e=o.root().source?.input.file;if(!e)return;let s=o.source?.input.file;if(!s||l.has(o))return;let t=o.params[0],r=t[0]===P&&t[t.length-1]===P?P:t[0]===R&&t[t.length-1]===R?R:null;if(!r)return;let n=o.params.slice(1,-1),p="";if(n.startsWith("!")&&(n=n.slice(1),p="!"),!n.startsWith("./")&&!n.startsWith("../"))return;let u=y.posix.join(I(y.dirname(s)),n),C=y.posix.dirname(I(e)),d=y.posix.relative(C,u);d.startsWith(".")||(d="./"+d),o.params=r+p+d+r,l.add(o)}return{postcssPlugin:"tailwindcss-postcss-fix-relative-paths",Once(o){o.walkAtRules(/source|plugin|config/,i)}}}var a=Z.DEBUG,T=new Y({maxSize:50});function oe(l,i){let o=`${l}:${i.base??""}:${JSON.stringify(i.optimize)}`;if(T.has(o))return T.get(o);let e={mtimes:new Map,compiler:null,scanner:null,tailwindCssAst:[],cachedPostCssAst:v.root(),optimizedPostCssAst:v.root(),fullRebuildPaths:[]};return T.set(o,e),e}function ne(l={}){let i=l.base??process.cwd(),o=l.optimize??process.env.NODE_ENV==="production";return{postcssPlugin:"@tailwindcss/postcss",plugins:[w(),{postcssPlugin:"tailwindcss",async Once(e,{result:s}){var O=[];try{let t=B(O,new ee);let r=s.opts.from??"";a&&t.start(`[@tailwindcss/postcss] ${W(i,r)}`);{a&&t.start("Quick bail check");let f=!0;if(e.walkAtRules(c=>{if(c.name==="import"||c.name==="theme"||c.name==="config"||c.name==="plugin"||c.name==="apply")return f=!1,!1}),f)return;a&&t.end("Quick bail check")}let n=oe(r,l);let p=m.dirname(m.resolve(r));async function u(){a&&t.start("Setup compiler"),n.fullRebuildPaths.length>0&&!C&&te(n.fullRebuildPaths),n.fullRebuildPaths=[],a&&t.start("PostCSS AST -> Tailwind CSS AST");let f=M(e);a&&t.end("PostCSS AST -> Tailwind CSS AST"),a&&t.start("Create compiler");let c=await J(f,{base:p,onDependency:h=>{n.fullRebuildPaths.push(h)}});return a&&t.end("Create compiler"),a&&t.end("Setup compiler"),c}let C=n.compiler===null;n.compiler??=await u();if(n.compiler.features===b.None)return;let d="incremental";a&&t.start("Register full rebuild paths");{for(let c of n.fullRebuildPaths)s.messages.push({type:"dependency",plugin:"@tailwindcss/postcss",file:m.resolve(c),parent:s.opts.from});let f=s.messages.flatMap(c=>c.type!=="dependency"?[]:c.file);f.push(r);for(let c of f){let h=re.statSync(c,{throwIfNoEntry:!1})?.mtimeMs??null;if(h===null){c===r&&(d="full");continue}n.mtimes.get(c)!==h&&(d="full",n.mtimes.set(c,h))}}a&&t.end("Register full rebuild paths");d==="full"&&!C&&(n.compiler=await u());if(n.scanner===null||d==="full"){a&&t.start("Setup scanner");let f=(n.compiler.root==="none"?[]:n.compiler.root===null?[{base:i,pattern:"**/*"}]:[n.compiler.root]).concat(n.compiler.globs);n.scanner=new se({sources:f}),a&&t.end("Setup scanner")}a&&t.start("Scan for candidates");let F=n.compiler.features&b.Utilities?n.scanner.scan():[];a&&t.end("Scan for candidates");if(n.compiler.features&b.Utilities){a&&t.start("Register dependency messages");for(let f of n.scanner.files)s.messages.push({type:"dependency",plugin:"@tailwindcss/postcss",file:m.resolve(f),parent:s.opts.from});for(let{base:f,pattern:c}of n.scanner.globs)c==="*"&&i===f||(c===""?s.messages.push({type:"dependency",plugin:"@tailwindcss/postcss",file:m.resolve(f),parent:s.opts.from}):s.messages.push({type:"dir-dependency",plugin:"@tailwindcss/postcss",dir:m.resolve(f),glob:c,parent:s.opts.from}));a&&t.end("Register dependency messages")}a&&t.start("Build utilities");let S=n.compiler.build(F);a&&t.end("Build utilities");if(n.tailwindCssAst!==S)if(o){a&&t.start("Optimization"),a&&t.start("AST -> CSS");let f=_(S);a&&t.end("AST -> CSS"),a&&t.start("Lightning CSS");let c=le(f,{minify:typeof o=="object"?o.minify:!0});a&&t.end("Lightning CSS"),a&&t.start("CSS -> PostCSS AST"),n.optimizedPostCssAst=v.parse(c,s.opts),a&&t.end("CSS -> PostCSS AST"),a&&t.end("Optimization")}else a&&t.start("Transform Tailwind CSS AST into PostCSS AST"),n.cachedPostCssAst=z(S,e.source),a&&t.end("Transform Tailwind CSS AST into PostCSS AST");n.tailwindCssAst=S;a&&t.start("Update PostCSS AST");e.removeAll();e.append(o?n.optimizedPostCssAst.clone().nodes:n.cachedPostCssAst.clone().nodes);e.raws.indent="  ";a&&t.end("Update PostCSS AST");a&&t.end(`[@tailwindcss/postcss] ${W(i,r)}`)}catch(G){var K=G,Q=!0}finally{U(O,K,Q)}}}]}}function le(l,{file:i="input.css",minify:o=!1}={}){function e(s){return ie({filename:i,code:s,minify:o,sourceMap:!1,drafts:{customMedia:!0},nonStandard:{deepSelectorCombinator:!0},include:E.Nesting,exclude:E.LogicalProperties|E.DirSelector,targets:{safari:16<<16|1024,ios_saf:16<<16|1024,firefox:8388608,chrome:7274496},errorRecovery:!0}).code}return e(e(Buffer.from(l))).toString()}var Oe=Object.assign(ne,{postcss:!0});export{Oe as default};
